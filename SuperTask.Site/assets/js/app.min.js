function sendFile(t,e){data=new FormData,data.append("file",t);var a=URL.createObjectURL(t);e.summernote("insertImage",a,function(t){$.ajax({url:"/Attachment/Image",data:data,cache:!1,contentType:!1,processData:!1,dataType:"json",type:"POST",success:function(e){t.attr("src",e.showUrl)}})})}function popupMessage(t,e){$().toastmessage("showToast",{text:t.msg,sticky:"success"!=t.result,type:t.result}),e&&jQuery.isFunction(e[t.result])&&e[t.result](t)}function findInViewModel(t,e,a,n){n=n||viewModel.dataList,$.each(n(),function(r,o){return o[t]==e?(a(o,r,n),!1):void 0})}function ajaxBindFileUpload(){Dropzone.autoDiscover=!1,$(".dropzone").dropzone({addedContainer:"#flyArea",dictResponseError:"上传出错",dictFileTooBig:"上传文件大小({{filesize}}MiB) 最大文件大小 ({{maxFilesize}}MiB)",uploadMultiple:!1,maxFilesize:200,init:function(){this.on("processing",function(){$(".progress").remove(),$("#uploadName").parent().parent().append(function(){return'<div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"><span class="sr-only"></span></div></div>'})}),this.on("totaluploadprogress",function(t){$(".progress-bar").css("width",parseInt(t)+"%")}),this.on("success",function(t,e){var a=$("#AttachmentUrl").val();a=a.length>0?a+"|":a;var n=$("#AttachmentName").val();n=n.length>0?n+"|":n,$("#AttachmentUrl").val(a+e.url),$("#AttachmentName").val(n+e.filename);var r=e.filename.length>40?e.filename.substring(0,37)+"...":e.filename;$("#uploadName").append('<p><label title="'+e.filename+'">'+r+'</label> <button type="button" class="btn btn-danger btn-xs btn-delete" onclick="delAttachment(this)">删除</button></p>')}),this.on("error",function(t,e){popupMessage({result:"error",msg:e})})}}),$("#btn-upload").on("click",function(){$(".dropzone").trigger("click"),$(".progress").hide(),$(".progress-bar").attr("style","width:0%")})}$(function(){$("form .multiselect").multiselect()}),$.ajaxSetup({cache:!1});var ajaxErrorMessage="操作出现异常！";$(function(){$(document).on("click.bs.modal.data-api",'[data-toggle="ajax-modal"]',function(){var t=$(this),e=t.data("url"),a=$(t.data("target"));$.get(e,function(t){a.html(t).modal("show").find(".form-control").first().focus()})})});var gridOptions={ajax:!0,padding:4,rowCount:[10,20,50,100],labels:{infos:"显示 {{ctx.start}} 到 {{ctx.end}} 共 {{ctx.total}} 记录",loading:"数据加载中...",noResults:"无可寻记录",refresh:"重新加载",search:"搜索"},templates:{footer:'<div id="{{ctx.id}}" class="{{css.footer}}"><div class="row infoBar"><p class="{{css.pagination}}"></p><p class="{{css.infos}}"></p></div></div>'},formatters:{Boolean:function(t,e){return e[t.id]?'<i class="fa fa-check-square-o fa-lg"></i>':""},Current:function(t,e){return"$"+e[t.id]},DateTime:function(t,e){return e[t.id]?moment(e[t.id]).format("YYYY-MM-DD hh:mm:ss"):""},DateOnly:function(t,e){return e[t.id]?moment(e[t.id]).format("YYYY-MM-DD"):""},Email:function(t,e){return"<a href='mailto:"+e[t.id]+"'>"+e[t.id]+"</a>"},Percent:function(t,e){return e[t.id]+" %"},TimeOnly:function(t,e){return e[t.id]},Url:function(t,e){var a=e[t.id],n=a;return"string"!=typeof a&&(n=a.url,a=a.text),"<a href='"+n+"'>"+a+"</a>"}},responseHandler:function(t){return t.errMessage?(alert(t.errMessage),{current:1,rowCount:10,rows:[],total:0}):t},loadDataErrorHandler:function(t){alert(t)}},dateRangeOption={autoApply:!0,locale:{format:"YYYY-MM-DD",separator:" 至 ",applyLabel:"Apply",cancelLabel:"Cancel",fromLabel:"From",toLabel:"To",customRangeLabel:"Custom",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1}};